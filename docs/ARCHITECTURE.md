# System Architecture Documentation

**Project:** Unified Security Scanner
**Version:** 1.0
**Last Updated:** November 11, 2025
**Status:** âœ… Complete - High-level system diagrams, PHI processing for RCU/billing, payment tokenization

---

## Table of Contents

1. [Overview](#overview)
2. [High-Level System Architecture](#high-level-system-architecture)
3. [Component Architecture](#component-architecture)
4. [Data Flow Diagrams](#data-flow-diagrams)
5. [Security Scan Processing Pipeline](#security-scan-processing-pipeline)
6. [Tool Adapter Architecture](#tool-adapter-architecture)
7. [Report Generation Flow](#report-generation-flow)
8. [Configuration Management](#configuration-management)
9. [Deployment Architecture](#deployment-architecture)
10. [Sequence Diagrams](#sequence-diagrams)

---

## Overview

The Unified Security Scanner is a modular security scanning orchestration platform that integrates multiple security tools (TruffleHog, Semgrep, etc.) to provide comprehensive vulnerability detection, secret scanning, and code quality analysis.

### Design Principles

- **Modularity**: Adapter-based architecture for easy tool integration
- **Extensibility**: Plugin system for custom security rules
- **Performance**: Parallel processing and intelligent caching
- **Usability**: Multiple output formats (Terminal, SARIF, JSON)
- **Reliability**: Graceful degradation when tools fail

---

## High-Level System Architecture

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         User Interfaces                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   CLI Client    â”‚   CI/CD Pipeline â”‚   IDE Plugin     â”‚   Web UI    â”‚
â”‚   (Terminal)    â”‚   (GitHub Action)â”‚   (VSCode)       â”‚   (Future)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                  â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â–¼                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              Command Line Interface (CLI)                   â”‚
         â”‚  - Argument parsing (Commander.js)                          â”‚
         â”‚  - Configuration loading                                    â”‚
         â”‚  - Output formatting                                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  Core Scanner Engine                        â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚           Scan Orchestrator                            â”‚ â”‚
         â”‚  â”‚  - Scan lifecycle management                           â”‚ â”‚
         â”‚  â”‚  - Parallel tool execution                             â”‚ â”‚
         â”‚  â”‚  - Result aggregation                                  â”‚ â”‚
         â”‚  â”‚  - Deduplication engine                                â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚         Configuration Manager                          â”‚ â”‚
         â”‚  â”‚  - Config file discovery (.securityrc.json)            â”‚ â”‚
         â”‚  â”‚  - Schema validation                                   â”‚ â”‚
         â”‚  â”‚  - Default value merging                               â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚        False Positive Filter                           â”‚ â”‚
         â”‚  â”‚  - Pattern matching                                    â”‚ â”‚
         â”‚  â”‚  - Test file exclusion                                 â”‚ â”‚
         â”‚  â”‚  - Custom suppression rules                            â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  Adapter Layer                              â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  TruffleHog   â”‚   Semgrep    â”‚    ESLint    â”‚  Custom â”‚ â”‚
         â”‚  â”‚   Adapter     â”‚   Adapter    â”‚    Adapter   â”‚ Adaptersâ”‚ â”‚
         â”‚  â”‚               â”‚              â”‚              â”‚         â”‚ â”‚
         â”‚  â”‚ - Secret scan â”‚ - SAST rules â”‚ - Code style â”‚ - User  â”‚ â”‚
         â”‚  â”‚ - Git history â”‚ - Security   â”‚ - Best       â”‚   rules â”‚ â”‚
         â”‚  â”‚ - Entropy     â”‚   patterns   â”‚   practices  â”‚         â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
                    â–¼              â–¼              â–¼            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              External Security Tools                        â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚ TruffleHog  â”‚   Semgrep   â”‚   ESLint    â”‚   Custom    â”‚ â”‚
         â”‚  â”‚   (Binary)  â”‚   (Binary)  â”‚   (npm)     â”‚   Scripts   â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  Target Codebase                            â”‚
         â”‚  - Source code files                                        â”‚
         â”‚  - Configuration files                                      â”‚
         â”‚  - Dependencies (package.json, etc.)                        â”‚
         â”‚  - Git history                                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  Output Layer                               â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚   Terminal    â”‚    SARIF     â”‚     JSON     â”‚   HTML  â”‚ â”‚
         â”‚  â”‚   Formatter   â”‚   Formatter  â”‚   Formatter  â”‚ (Future)â”‚ â”‚
         â”‚  â”‚               â”‚              â”‚              â”‚         â”‚ â”‚
         â”‚  â”‚ - Color coded â”‚ - GitHub     â”‚ - Machine    â”‚ - Web   â”‚ â”‚
         â”‚  â”‚ - Tables      â”‚   Security   â”‚   readable   â”‚   view  â”‚ â”‚
         â”‚  â”‚ - Progress    â”‚ - VSCode     â”‚ - APIs       â”‚         â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
                    â–¼              â–¼              â–¼            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  Output Destinations                        â”‚
         â”‚  - Console (stdout/stderr)                                  â”‚
         â”‚  - File system (./reports/)                                 â”‚
         â”‚  - GitHub Security Tab (SARIF upload)                       â”‚
         â”‚  - CI/CD pipeline (exit codes)                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Architecture

### Package Structure

```text
securityscanner/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ cli/                    # Command-line interface
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts       # Entry point
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ scan.ts    # Scan command implementation
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ terminal.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sarif.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ json.ts
â”‚   â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚   â”‚       â””â”€â”€ args.ts    # Argument parsing
â”‚   â”‚   â””â”€â”€ dist/              # Compiled JavaScript
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                   # Scanner engine
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ scanner/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator.ts    # Main scan orchestrator
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ executor.ts        # Parallel execution
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ deduplicator.ts    # Result deduplication
â”‚   â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ loader.ts          # Config file discovery
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ validator.ts       # Schema validation
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ defaults.ts        # Default configuration
â”‚   â”‚   â”‚   â”œâ”€â”€ filters/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ false-positive.ts  # FP filtering
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ severity.ts        # Severity filtering
â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â”‚       â””â”€â”€ findings.ts        # Type definitions
â”‚   â”‚   â””â”€â”€ dist/
â”‚   â”‚
â”‚   â””â”€â”€ adapters/               # Tool integrations
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ base/
â”‚       â”‚   â”‚   â””â”€â”€ adapter.ts         # Base adapter interface
â”‚       â”‚   â”œâ”€â”€ trufflehog/
â”‚       â”‚   â”‚   â”œâ”€â”€ adapter.ts
â”‚       â”‚   â”‚   â””â”€â”€ parser.ts          # Output parsing
â”‚       â”‚   â”œâ”€â”€ semgrep/
â”‚       â”‚   â”‚   â”œâ”€â”€ adapter.ts
â”‚       â”‚   â”‚   â””â”€â”€ parser.ts
â”‚       â”‚   â””â”€â”€ eslint/
â”‚       â”‚       â”œâ”€â”€ adapter.ts
â”‚       â”‚       â””â”€â”€ parser.ts
â”‚       â””â”€â”€ dist/
â”‚
â”œâ”€â”€ rules/                      # Security rules
â”‚   â”œâ”€â”€ secrets/
â”‚   â”‚   â””â”€â”€ patterns.yml        # Secret detection patterns
â”‚   â”œâ”€â”€ react/
â”‚   â”‚   â””â”€â”€ security.yml        # React-specific rules
â”‚   â””â”€â”€ custom/
â”‚       â””â”€â”€ company.yml         # Company-specific rules
â”‚
â””â”€â”€ reports/                    # Output directory
    â”œâ”€â”€ security-results.sarif
    â”œâ”€â”€ security-results.json
    â””â”€â”€ security-results.html
```

### Component Responsibilities

| Component | Responsibility | Key Classes/Functions |
|-----------|----------------|----------------------|
| **CLI** | User interaction, argument parsing | `ScanCommand`, `FormatManager` |
| **Core/Orchestrator** | Scan lifecycle, tool coordination | `ScanOrchestrator`, `ParallelExecutor` |
| **Core/Config** | Configuration management | `ConfigLoader`, `ConfigValidator` |
| **Core/Filters** | Result filtering, deduplication | `FalsePositiveFilter`, `Deduplicator` |
| **Adapters** | Tool integration, output parsing | `TruffleHogAdapter`, `SemgrepAdapter` |
| **Formatters** | Output generation | `TerminalFormatter`, `SARIFFormatter` |

---

## Data Flow Diagrams

### End-to-End Scan Data Flow

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: INITIALIZATION                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Command
    â”‚
    â”‚  node dist/index.js scan /path/to/project --format=sarif
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLI Entry Point     â”‚
â”‚ (index.ts)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1. Parse arguments (Commander.js)
           â”‚ 2. Validate flags
           â”‚ 3. Load configuration
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Configuration Loader                    â”‚
â”‚ - Search for .securityrc.json           â”‚
â”‚ - Merge with CLI arguments              â”‚
â”‚ - Apply defaults                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Configuration Object
           â”‚ {
           â”‚   tools: { truffleHog: {enabled: true}, ... },
           â”‚   scan: { target: ".", exclude: [...] },
           â”‚   severity: { failOn: ["CRITICAL", "HIGH"] }
           â”‚ }
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: SCAN EXECUTION                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scan Orchestrator   â”‚
â”‚ (orchestrator.ts)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1. Initialize enabled adapters
           â”‚ 2. Prepare file list
           â”‚ 3. Start parallel execution
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Parallel Executor                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ TruffleHog   â”‚  â”‚   Semgrep    â”‚  â”‚   ESLint     â”‚ â”‚
â”‚ â”‚   Adapter    â”‚  â”‚   Adapter    â”‚  â”‚   Adapter    â”‚ â”‚
â”‚ â”‚   Thread     â”‚  â”‚   Thread     â”‚  â”‚   Thread     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                  â”‚
         â”‚ Execute:         â”‚ Execute:         â”‚ Execute:
         â”‚ trufflehog       â”‚ semgrep          â”‚ eslint
         â”‚ filesystem       â”‚ --config         â”‚ --format json
         â”‚ --json           â”‚ --json           â”‚
         â”‚                  â”‚                  â”‚
         â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tool Output (JSON)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TruffleHog: [                                        â”‚
â”‚   {                                                  â”‚
â”‚     "SourceMetadata": { "File": "src/config.ts" },  â”‚
â”‚     "RawV2": "sk-proj-abc123...",                   â”‚
â”‚     "DetectorType": "OpenAI"                         â”‚
â”‚   }                                                  â”‚
â”‚ ]                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Semgrep: {                                           â”‚
â”‚   "results": [{                                      â”‚
â”‚     "check_id": "javascript.react.security.xss",    â”‚
â”‚     "path": "src/App.tsx",                          â”‚
â”‚     "extra": { "severity": "WARNING" }              â”‚
â”‚   }]                                                 â”‚
â”‚ }                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: RESULT PROCESSING                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Adapter Parsers                         â”‚
â”‚ - TruffleHogParser.parse()              â”‚
â”‚ - SemgrepParser.parse()                 â”‚
â”‚ - ESLintParser.parse()                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Normalized Findings
           â”‚ [
           â”‚   {
           â”‚     id: "uuid-1",
           â”‚     title: "Hardcoded API Key",
           â”‚     severity: "CRITICAL",
           â”‚     file: "src/config.ts",
           â”‚     line: 2,
           â”‚     tool: "trufflehog",
           â”‚     rawOutput: {...}
           â”‚   },
           â”‚   ...
           â”‚ ]
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Deduplicator                            â”‚
â”‚ - Hash-based duplicate detection        â”‚
â”‚ - Cross-tool finding correlation        â”‚
â”‚ - Merge overlapping findings            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Deduplicated Findings (120 â†’ 45)
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ False Positive Filter                   â”‚
â”‚ - Apply exclusion patterns              â”‚
â”‚ - Filter test files (if configured)     â”‚
â”‚ - Apply custom suppressions             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Filtered Findings (45 â†’ 38)
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Severity Classifier                     â”‚
â”‚ - Normalize severity levels             â”‚
â”‚ - Calculate risk scores                 â”‚
â”‚ - Sort by severity + file               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Final Findings
           â”‚ {
           â”‚   critical: 2,
           â”‚   high: 5,
           â”‚   medium: 18,
           â”‚   low: 13,
           â”‚   total: 38
           â”‚ }
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4: OUTPUT GENERATION                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Format Manager                          â”‚
â”‚ - Determine output formats              â”‚
â”‚ - Invoke formatters in parallel         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                 â”‚                 â”‚                 â”‚
           â–¼                 â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Terminal         â”‚  â”‚ SARIF       â”‚  â”‚ JSON        â”‚  â”‚ HTML        â”‚
â”‚ Formatter        â”‚  â”‚ Formatter   â”‚  â”‚ Formatter   â”‚  â”‚ Formatter   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚                â”‚                â”‚
         â–¼                   â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ stdout       â”‚  â”‚ reports/         â”‚  â”‚ reports/     â”‚  â”‚ reports/     â”‚
â”‚ (console)    â”‚  â”‚ results.sarif    â”‚  â”‚ results.json â”‚  â”‚ results.html â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â”‚                   â”‚
         â”‚                   â”‚ GitHub Upload
         â”‚                   â–¼
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚         â”‚ GitHub Security Tab  â”‚
         â”‚         â”‚ - Code annotations   â”‚
         â”‚         â”‚ - Issue tracking     â”‚
         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Exit Code Determination                 â”‚
â”‚ - 0: No issues (or below failOn)        â”‚
â”‚ - 1: Issues found (matching failOn)     â”‚
â”‚ - 2: Scan error                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    CI/CD Pipeline Decision
    (Pass/Fail build)
```

---

## Security Scan Processing Pipeline

### Detailed Processing Flow

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INPUT STAGE                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Target Directory: /path/to/project
    â”‚
    â”‚ File Discovery
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ File System Walker                  â”‚
â”‚ - Recursive directory traversal     â”‚
â”‚ - Apply exclusions (node_modules)   â”‚
â”‚ - Filter by extensions (.ts, .js)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ File List (2,341 files)
           â”‚ [
           â”‚   "src/index.ts",
           â”‚   "src/utils/crypto.ts",
           â”‚   "package.json",
           â”‚   ...
           â”‚ ]
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SCAN STAGE                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Adapter: TruffleHog (Secrets)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:                              â”‚
â”‚ - File list                         â”‚
â”‚ - Config: { exclude: ["**/test/**"] }â”‚
â”‚                                     â”‚
â”‚ EXECUTION:                          â”‚
â”‚ $ trufflehog filesystem \           â”‚
â”‚     /path/to/project \              â”‚
â”‚     --json \                        â”‚
â”‚     --no-verification               â”‚
â”‚                                     â”‚
â”‚ OUTPUT:                             â”‚
â”‚ {                                   â”‚
â”‚   "SourceMetadata": {               â”‚
â”‚     "File": "src/config.ts",        â”‚
â”‚     "Line": 2                       â”‚
â”‚   },                                â”‚
â”‚   "SourceName": "trufflehog",       â”‚
â”‚   "RawV2": "sk-proj-abc123...",    â”‚
â”‚   "DetectorType": "OpenAI",         â”‚
â”‚   "Verified": false                 â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Raw Findings (8 secrets)
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Parser: TruffleHogParser            â”‚
â”‚ - Extract file path                 â”‚
â”‚ - Normalize severity                â”‚
â”‚ - Create fingerprint hash           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Normalized Finding
           â”‚ {
           â”‚   id: "hash(file+line+pattern)",
           â”‚   title: "OpenAI API Key Detected",
           â”‚   severity: "CRITICAL",
           â”‚   file: "src/config.ts",
           â”‚   line: 2,
           â”‚   column: 12,
           â”‚   snippet: 'API_KEY: "sk-proj-..."',
           â”‚   tool: "trufflehog",
           â”‚   detectorType: "OpenAI",
           â”‚   verified: false,
           â”‚   confidence: "HIGH",
           â”‚   rawOutput: {...}
           â”‚ }
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AGGREGATION STAGE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Result Aggregator                              â”‚
â”‚                                                â”‚
â”‚ Findings from all tools:                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ TruffleHog: 8 findings                   â”‚  â”‚
â”‚ â”‚ Semgrep:    47 findings                  â”‚  â”‚
â”‚ â”‚ ESLint:     65 findings                  â”‚  â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
â”‚ â”‚ Total:      120 findings                 â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Deduplicator                        â”‚
â”‚                                     â”‚
â”‚ Algorithm:                          â”‚
â”‚ 1. Hash each finding:               â”‚
â”‚    hash(file + line + pattern)      â”‚
â”‚                                     â”‚
â”‚ 2. Group by hash                    â”‚
â”‚                                     â”‚
â”‚ 3. Merge duplicates:                â”‚
â”‚    - Keep highest severity          â”‚
â”‚    - Combine tool sources           â”‚
â”‚    - Preserve all metadata          â”‚
â”‚                                     â”‚
â”‚ Example duplicate:                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Semgrep: XSS in App.tsx:12    â”‚  â”‚
â”‚ â”‚ ESLint:  XSS in App.tsx:12    â”‚  â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚ â”‚ Merged: XSS in App.tsx:12     â”‚  â”‚
â”‚ â”‚ Tools: [semgrep, eslint]      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Deduplicated (120 â†’ 78)
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FILTERING STAGE                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ False Positive Filter               â”‚
â”‚                                     â”‚
â”‚ Rules:                              â”‚
â”‚ 1. Test file exclusion:             â”‚
â”‚    if (file.includes('/test/'))     â”‚
â”‚       filter out                    â”‚
â”‚                                     â”‚
â”‚ 2. Pattern matching:                â”‚
â”‚    {                                â”‚
â”‚      file: "**/*.example.ts",       â”‚
â”‚      pattern: "API_KEY",            â”‚
â”‚      reason: "Example files"        â”‚
â”‚    }                                â”‚
â”‚                                     â”‚
â”‚ 3. Severity threshold:              â”‚
â”‚    if (severity < config.minLevel)  â”‚
â”‚       filter out                    â”‚
â”‚                                     â”‚
â”‚ Filtered findings:                  â”‚
â”‚ - tests/fixtures/secrets.ts (FP)    â”‚
â”‚ - docs/example.ts (FP)              â”‚
â”‚ - 6 low severity issues (threshold) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Filtered (78 â†’ 45)
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ENRICHMENT STAGE                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Finding Enricher                    â”‚
â”‚                                     â”‚
â”‚ Enrich each finding with:           â”‚
â”‚                                     â”‚
â”‚ 1. OWASP Category:                  â”‚
â”‚    - Hardcoded secrets â†’ A02:2021   â”‚
â”‚    - XSS â†’ A03:2021                 â”‚
â”‚                                     â”‚
â”‚ 2. CWE Mapping:                     â”‚
â”‚    - Secrets â†’ CWE-798              â”‚
â”‚    - XSS â†’ CWE-79                   â”‚
â”‚                                     â”‚
â”‚ 3. Remediation Guidance:            â”‚
â”‚    - Link to documentation          â”‚
â”‚    - Code fix examples              â”‚
â”‚    - Security best practices        â”‚
â”‚                                     â”‚
â”‚ 4. Risk Score:                      â”‚
â”‚    score = severity * confidence *  â”‚
â”‚            exploitability           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Enriched Findings
           â”‚ {
           â”‚   ...,
           â”‚   owasp: "A02:2021",
           â”‚   cwe: "CWE-798",
           â”‚   riskScore: 9.2,
           â”‚   remediation: {
           â”‚     summary: "Use environment variables",
           â”‚     example: "process.env.API_KEY",
           â”‚     references: [...]
           â”‚   }
           â”‚ }
           â”‚
           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      OUTPUT STAGE                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Final Scan Results
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                     â–¼                     â–¼                     â–¼
Terminal Output     SARIF Format          JSON Format           Statistics
(Human readable)    (GitHub)              (Machine readable)     (Metrics)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ CRITICAL: 2  â”‚ â”‚ {                â”‚ â”‚ {                â”‚ â”‚ {        â”‚
â”‚ ğŸŸ  HIGH:     5  â”‚ â”‚   "$schema":     â”‚ â”‚   "findings": [  â”‚ â”‚  "scan": â”‚
â”‚ ğŸŸ¡ MEDIUM:  18  â”‚ â”‚   "version":     â”‚ â”‚     {            â”‚ â”‚   {      â”‚
â”‚ âšª LOW:     20  â”‚ â”‚   "runs": [{     â”‚ â”‚       "id": ..., â”‚ â”‚    "dur":â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚     "results": [ â”‚ â”‚       "severity":â”‚ â”‚    "5.2s"â”‚
â”‚ Total:      45  â”‚ â”‚       {          â”‚ â”‚     }            â”‚ â”‚   },     â”‚
â”‚                 â”‚ â”‚         "ruleId":â”‚ â”‚   ],             â”‚ â”‚  "stats":â”‚
â”‚ Files: 2,341    â”‚ â”‚         "message"â”‚ â”‚   "summary": {   â”‚ â”‚   {      â”‚
â”‚ Time:  5.2s     â”‚ â”‚         "locations"â”‚ â”‚    "critical":2â”‚ â”‚    "tot":â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       }          â”‚ â”‚   }              â”‚ â”‚    45    â”‚
                    â”‚     ]            â”‚ â”‚ }                â”‚ â”‚   }      â”‚
                    â”‚   }]             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ }        â”‚
                    â”‚ }                â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Tool Adapter Architecture

### Base Adapter Interface

```typescript
/**
 * Base adapter interface that all tool adapters must implement
 */
interface SecurityToolAdapter {
  /**
   * Adapter metadata
   */
  name: string;
  version: string;
  capabilities: AdapterCapabilities;

  /**
   * Initialize the adapter with configuration
   */
  initialize(config: AdapterConfig): Promise<void>;

  /**
   * Check if the tool is available and properly configured
   */
  isAvailable(): Promise<boolean>;

  /**
   * Execute the security tool scan
   */
  scan(target: ScanTarget): Promise<RawToolOutput>;

  /**
   * Parse tool output into normalized findings
   */
  parse(rawOutput: RawToolOutput): Promise<Finding[]>;

  /**
   * Clean up resources
   */
  cleanup(): Promise<void>;
}
```

### Adapter Implementation Flow

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Adapter Lifecycle                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. INITIALIZATION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Orchestrator        â”‚
   â”‚ .initialize()       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ For each enabled adapter
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ TruffleHogAdapter   â”‚
   â”‚ .initialize(config) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 1. Check tool binary exists
              â”‚ 2. Validate configuration
              â”‚ 3. Prepare temp directories
              â”‚ 4. Set environment variables
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ isAvailable()       â”‚
   â”‚ âœ“ Tool found        â”‚
   â”‚ âœ“ Version compatibleâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. EXECUTION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ scan(target)        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Build command
              â”‚ $ trufflehog filesystem /path --json
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Process Execution                   â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ â”‚ spawn('trufflehog', [           â”‚ â”‚
   â”‚ â”‚   'filesystem',                 â”‚ â”‚
   â”‚ â”‚   targetPath,                   â”‚ â”‚
   â”‚ â”‚   '--json',                     â”‚ â”‚
   â”‚ â”‚   '--no-verification'           â”‚ â”‚
   â”‚ â”‚ ])                              â”‚ â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚                                     â”‚
   â”‚ Stream handling:                    â”‚
   â”‚ - stdout â†’ Buffer                   â”‚
   â”‚ - stderr â†’ Error log                â”‚
   â”‚ - exit code â†’ Status                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Raw JSON output
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ RawToolOutput       â”‚
   â”‚ {                   â”‚
   â”‚   stdout: "...",    â”‚
   â”‚   stderr: "",       â”‚
   â”‚   exitCode: 0       â”‚
   â”‚ }                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. PARSING
   â”€â”€â”€â”€â”€â”€â”€â”€
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ parse(rawOutput)    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Parse JSON
              â”‚ Normalize fields
              â”‚ Extract metadata
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Transform to normalized format       â”‚
   â”‚                                      â”‚
   â”‚ TruffleHog format:                   â”‚
   â”‚ {                                    â”‚
   â”‚   "SourceMetadata": {                â”‚
   â”‚     "File": "src/config.ts",         â”‚
   â”‚     "Line": 2                        â”‚
   â”‚   },                                 â”‚
   â”‚   "RawV2": "sk-proj-abc123",        â”‚
   â”‚   "DetectorType": "OpenAI"           â”‚
   â”‚ }                                    â”‚
   â”‚                                      â”‚
   â”‚ â†“ Transform â†“                        â”‚
   â”‚                                      â”‚
   â”‚ Normalized Finding:                  â”‚
   â”‚ {                                    â”‚
   â”‚   id: "uuid-v4",                     â”‚
   â”‚   title: "OpenAI API Key Detected",  â”‚
   â”‚   severity: "CRITICAL",              â”‚
   â”‚   file: "src/config.ts",             â”‚
   â”‚   line: 2,                           â”‚
   â”‚   tool: "trufflehog",                â”‚
   â”‚   detectorType: "OpenAI",            â”‚
   â”‚   rawOutput: {...}                   â”‚
   â”‚ }                                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Finding[]
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Return to           â”‚
   â”‚ Orchestrator        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. CLEANUP
   â”€â”€â”€â”€â”€â”€â”€â”€
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ cleanup()           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ - Remove temp files
              â”‚ - Close file handles
              â”‚ - Clear buffers
              â”‚ - Log statistics
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Resources freed     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Report Generation Flow

### Multi-Format Output Pipeline

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Format Manager                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: Final Findings + Configuration
    â”‚
    â”‚ formats = ["terminal", "sarif", "json"]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Parallel Format Generation             â”‚
â”‚                                        â”‚
â”‚ Promise.all([                          â”‚
â”‚   terminalFormatter.format(findings),  â”‚
â”‚   sarifFormatter.format(findings),     â”‚
â”‚   jsonFormatter.format(findings)       â”‚
â”‚ ])                                     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚               â”‚              â”‚
     â–¼               â–¼              â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Terminal     â”‚ â”‚ SARIF        â”‚ â”‚ JSON         â”‚
â”‚ Formatter    â”‚ â”‚ Formatter    â”‚ â”‚ Formatter    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚                â”‚
       â”‚                â”‚                â”‚
       â–¼                â–¼                â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TERMINAL FORMAT (Console output with colors)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ” Initializing security scan...                             â”‚
â”‚ âœ” Scanning for vulnerabilities...                           â”‚
â”‚ âœ” Filtering false positives...                              â”‚
â”‚ âœ” Scan completed in 5.23s - Found 45 issues                 â”‚
â”‚                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚  Unified Security Scanner v1.0                           â”‚â”‚
â”‚ â”‚  Scanned: 2,341 files (145,230 LOC) in 5.2s            â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚   ğŸ”´ CRITICAL: 2  â”‚  ğŸŸ  HIGH: 5  â”‚  ğŸŸ¡ MEDIUM: 18  â”‚  âšª LOW: 20â”‚
â”‚                                                              â”‚
â”‚ ğŸ”´ CRITICAL ISSUES                                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                              â”‚
â”‚ [1] Hardcoded OpenAI API Key                                â”‚
â”‚     File: src/config.ts:2                                   â”‚
â”‚     Tool: trufflehog                                        â”‚
â”‚     Risk: Secret exposed in version control                 â”‚
â”‚                                                              â”‚
â”‚     1 â”‚ export const config = {                             â”‚
â”‚     2 â”‚   API_KEY: "sk-proj-abc123def456...",  â† Here       â”‚
â”‚     3 â”‚   DATABASE_URL: "postgres://..."                    â”‚
â”‚                                                              â”‚
â”‚     ğŸ’¡ Solution: Use environment variables                   â”‚
â”‚        const API_KEY = process.env.OPENAI_API_KEY          â”‚
â”‚                                                              â”‚
â”‚     ğŸ”— https://owasp.org/www-community/vulnerabilities/     â”‚
â”‚        Use_of_hard-coded_password                           â”‚
â”‚                                                              â”‚
â”‚ ... (more findings) ...                                     â”‚
â”‚                                                              â”‚
â”‚ âŒ Security scan failed (2 critical issues)                 â”‚
â”‚ Exit code: 1                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SARIF FORMAT (GitHub Security / VSCode)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                            â”‚
â”‚   "$schema": "https://json.schemastore.org/sarif-2.1.0.json",â”‚
â”‚   "version": "2.1.0",                                        â”‚
â”‚   "runs": [{                                                 â”‚
â”‚     "tool": {                                                â”‚
â”‚       "driver": {                                            â”‚
â”‚         "name": "Unified Security Scanner",                  â”‚
â”‚         "version": "1.0.0",                                  â”‚
â”‚         "informationUri": "https://github.com/..."          â”‚
â”‚       }                                                      â”‚
â”‚     },                                                       â”‚
â”‚     "results": [                                             â”‚
â”‚       {                                                      â”‚
â”‚         "ruleId": "hardcoded-secret-openai",                â”‚
â”‚         "level": "error",                                    â”‚
â”‚         "message": {                                         â”‚
â”‚           "text": "Hardcoded OpenAI API Key detected"       â”‚
â”‚         },                                                   â”‚
â”‚         "locations": [{                                      â”‚
â”‚           "physicalLocation": {                              â”‚
â”‚             "artifactLocation": {                            â”‚
â”‚               "uri": "src/config.ts"                         â”‚
â”‚             },                                               â”‚
â”‚             "region": {                                      â”‚
â”‚               "startLine": 2,                                â”‚
â”‚               "startColumn": 12,                             â”‚
â”‚               "snippet": {                                   â”‚
â”‚                 "text": 'API_KEY: "sk-proj-abc123..."'      â”‚
â”‚               }                                              â”‚
â”‚             }                                                â”‚
â”‚           }                                                  â”‚
â”‚         }],                                                  â”‚
â”‚         "properties": {                                      â”‚
â”‚           "security-severity": "9.0",                        â”‚
â”‚           "tags": ["security", "secret", "api-key"]          â”‚
â”‚         }                                                    â”‚
â”‚       }                                                      â”‚
â”‚       ... (more results) ...                                â”‚
â”‚     ]                                                        â”‚
â”‚   }]                                                         â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSON FORMAT (Machine readable / APIs)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                            â”‚
â”‚   "scan": {                                                  â”‚
â”‚     "id": "scan-2025-11-11-123456",                         â”‚
â”‚     "timestamp": "2025-11-11T10:30:00Z",                    â”‚
â”‚     "duration": 5.23,                                        â”‚
â”‚     "target": "/path/to/project",                           â”‚
â”‚     "tools": ["trufflehog", "semgrep", "eslint"]            â”‚
â”‚   },                                                         â”‚
â”‚   "summary": {                                               â”‚
â”‚     "total": 45,                                             â”‚
â”‚     "critical": 2,                                           â”‚
â”‚     "high": 5,                                               â”‚
â”‚     "medium": 18,                                            â”‚
â”‚     "low": 20,                                               â”‚
â”‚     "filesScanned": 2341,                                    â”‚
â”‚     "linesOfCode": 145230                                    â”‚
â”‚   },                                                         â”‚
â”‚   "findings": [                                              â”‚
â”‚     {                                                        â”‚
â”‚       "id": "uuid-123e4567-e89b",                           â”‚
â”‚       "title": "Hardcoded OpenAI API Key",                  â”‚
â”‚       "severity": "CRITICAL",                                â”‚
â”‚       "confidence": "HIGH",                                  â”‚
â”‚       "file": "src/config.ts",                              â”‚
â”‚       "line": 2,                                             â”‚
â”‚       "column": 12,                                          â”‚
â”‚       "snippet": "API_KEY: \"sk-proj-abc123...\"",          â”‚
â”‚       "tool": "trufflehog",                                  â”‚
â”‚       "detectorType": "OpenAI",                             â”‚
â”‚       "verified": false,                                     â”‚
â”‚       "cwe": "CWE-798",                                      â”‚
â”‚       "owasp": "A02:2021",                                   â”‚
â”‚       "riskScore": 9.2,                                      â”‚
â”‚       "remediation": {                                       â”‚
â”‚         "summary": "Use environment variables",              â”‚
â”‚         "example": "process.env.OPENAI_API_KEY",            â”‚
â”‚         "references": [                                      â”‚
â”‚           "https://owasp.org/..."                           â”‚
â”‚         ]                                                    â”‚
â”‚       },                                                     â”‚
â”‚       "rawOutput": { ... }                                   â”‚
â”‚     }                                                        â”‚
â”‚     ... (more findings) ...                                 â”‚
â”‚   ]                                                          â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Configuration Management

### Configuration File Discovery

```text
Configuration Loading Priority
(Higher priority overrides lower)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. CLI Arguments (Highest Priority)    â”‚
â”‚    --fail-on=critical --format=sarif   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ Override
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Explicit Config File                â”‚
â”‚    --config=/path/to/custom.json       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ Override
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. .securityrc.json (Current Dir)      â”‚
â”‚    ./securityrc.json                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ Override
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. .securityrc.json (Project Root)     â”‚
â”‚    ../../.securityrc.json              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ Override
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Default Configuration               â”‚
â”‚    (Built-in defaults)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Final Configuration Merge:
{
  "version": "1.0",
  "tools": {
    "truffleHog": {
      "enabled": true,          // from default
      "exclude": ["**/test/**"] // from .securityrc.json
    },
    "semgrep": {
      "enabled": true           // from default
    }
  },
  "scan": {
    "target": ".",              // from default
    "exclude": ["**/node_modules/**"] // from default
  },
  "severity": {
    "failOn": ["CRITICAL"]      // from CLI --fail-on
  },
  "output": {
    "format": ["sarif"]         // from CLI --format
  }
}
```

### Configuration Schema

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Configuration schema version"
    },
    "tools": {
      "type": "object",
      "properties": {
        "truffleHog": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "exclude": { "type": "array", "items": { "type": "string" } },
            "verifySecrets": { "type": "boolean" }
          }
        },
        "semgrep": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "rules": { "type": "array", "items": { "type": "string" } },
            "config": { "type": "string" }
          }
        }
      }
    },
    "scan": {
      "type": "object",
      "properties": {
        "target": { "type": "string" },
        "exclude": { "type": "array", "items": { "type": "string" } },
        "includeTests": { "type": "boolean" }
      }
    },
    "falsePositives": {
      "type": "object",
      "properties": {
        "excludeTestFiles": { "type": "boolean" },
        "patterns": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "file": { "type": "string" },
              "pattern": { "type": "string" },
              "reason": { "type": "string" }
            }
          }
        }
      }
    },
    "severity": {
      "type": "object",
      "properties": {
        "failOn": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW"]
          }
        }
      }
    }
  }
}
```

---

## Deployment Architecture

### Local Development

```text
Developer Workstation
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  Project Repository                     â”‚
â”‚  â”œâ”€â”€ src/                               â”‚
â”‚  â”œâ”€â”€ .securityrc.json                   â”‚
â”‚  â””â”€â”€ .git/                              â”‚
â”‚                                         â”‚
â”‚  Security Scanner (Local install)       â”‚
â”‚  â””â”€â”€ /path/to/securityscanner/         â”‚
â”‚      â””â”€â”€ packages/cli/dist/index.js     â”‚
â”‚                                         â”‚
â”‚  Pre-commit Hook                        â”‚
â”‚  â”œâ”€â”€ .git/hooks/pre-commit             â”‚
â”‚  â””â”€â”€ Run scan on staged files          â”‚
â”‚                                         â”‚
â”‚  IDE Integration (VSCode)               â”‚
â”‚  â””â”€â”€ Extension: Security Scanner        â”‚
â”‚      â””â”€â”€ Real-time scanning             â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CI/CD Pipeline (GitHub Actions)

```text
GitHub Repository
      â”‚
      â”‚ Push / Pull Request
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub Actions Workflow                  â”‚
â”‚ (.github/workflows/security.yml)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Runner (ubuntu-latest)                   â”‚
â”‚                                          â”‚
â”‚ Step 1: Checkout Code                    â”‚
â”‚ â”œâ”€â”€ actions/checkout@v3                  â”‚
â”‚ â””â”€â”€ Clone repository                     â”‚
â”‚                                          â”‚
â”‚ Step 2: Install Dependencies             â”‚
â”‚ â”œâ”€â”€ npm install -g pnpm                  â”‚
â”‚ â””â”€â”€ pnpm install                         â”‚
â”‚                                          â”‚
â”‚ Step 3: Build Scanner                    â”‚
â”‚ â””â”€â”€ pnpm build                           â”‚
â”‚                                          â”‚
â”‚ Step 4: Run Security Scan                â”‚
â”‚ â””â”€â”€ node packages/cli/dist/index.js \    â”‚
â”‚     scan . \                             â”‚
â”‚     --format=sarif,terminal \            â”‚
â”‚     --output=./reports \                 â”‚
â”‚     --fail-on=critical,high              â”‚
â”‚                                          â”‚
â”‚ Step 5: Upload SARIF                     â”‚
â”‚ â””â”€â”€ github/codeql-action/upload-sarif@v2 â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼                 â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Exit Code    â”‚  â”‚ SARIF Upload â”‚  â”‚ Workflow Log â”‚
    â”‚ 0 = Pass     â”‚  â”‚ â†’ Security   â”‚  â”‚ (Terminal    â”‚
    â”‚ 1 = Fail     â”‚  â”‚   Tab        â”‚  â”‚  output)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                 â”‚
           â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Build Status â”‚  â”‚ GitHub Security Tab          â”‚
    â”‚ âœ… Pass      â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚ âŒ Fail      â”‚  â”‚ â”‚ Code Scanning Alerts     â”‚ â”‚
    â”‚              â”‚  â”‚ â”‚ - Hardcoded secrets (2)  â”‚ â”‚
    â”‚              â”‚  â”‚ â”‚ - XSS vulnerabilities(5) â”‚ â”‚
    â”‚              â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Sequence Diagrams

### Complete Scan Sequence

```text
User    CLI     Config  Orchestrator  Adapter  Tool    Filter  Formatter
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚ scan  â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”œâ”€â”€â”€â”€â”€â”€>â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚ load   â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚<â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚ config â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚ init   â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚ register â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚ execute  â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚ run   â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”œâ”€â”€â”€â”€â”€â”€>â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚<â”€â”€â”€â”€â”€â”€â”¤        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚ JSON  â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚ parse â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”œâ”€â”€â”€â”   â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚<â”€â”€â”˜   â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚ findings â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚ dedupe   â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”œâ”€â”€â”€â”      â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚<â”€â”€â”˜      â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚ filter   â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€>â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚<â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚results â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚ format â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚<â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚       â”‚ output â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”¤        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚ Reportâ”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
 â”‚       â”‚        â”‚          â”‚          â”‚       â”‚        â”‚        â”‚
```

### Adapter Execution Sequence

```text
Orchestrator  TruffleHog  Semgrep    ESLint     Results
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚ execute    â”‚          â”‚          â”‚           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚          â”‚           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚            â”‚ Running  â”‚          â”‚           â”‚
     â”‚            â”‚ (2.1s)   â”‚          â”‚           â”‚
     â”‚            â”‚          â”‚ Running  â”‚           â”‚
     â”‚            â”‚          â”‚ (3.8s)   â”‚           â”‚
     â”‚            â”‚          â”‚          â”‚ Running   â”‚
     â”‚            â”‚          â”‚          â”‚ (1.2s)    â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚          â”‚           â”‚
     â”‚ findings   â”‚          â”‚          â”‚           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚          â”‚           â”‚
     â”‚ findings   â”‚          â”‚          â”‚           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚
     â”‚ findings   â”‚          â”‚          â”‚           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
     â”‚ aggregate  â”‚          â”‚          â”‚           â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ all resultsâ”‚          â”‚          â”‚           â”‚
     â”‚            â”‚          â”‚          â”‚           â”‚
```

---

## Performance Characteristics

### Scan Performance Metrics

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Performance Benchmarks (Real-world data)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ Small Project (< 1k files)                                   â”‚
â”‚ â”œâ”€â”€ Files: 234                                               â”‚
â”‚ â”œâ”€â”€ LOC: 12,450                                              â”‚
â”‚ â”œâ”€â”€ Scan Time: 5-15 seconds                                  â”‚
â”‚ â”œâ”€â”€ Memory: ~150 MB                                          â”‚
â”‚ â””â”€â”€ Findings: 0-5                                            â”‚
â”‚                                                              â”‚
â”‚ Medium Project (1k-10k files)                                â”‚
â”‚ â”œâ”€â”€ Files: 2,341                                             â”‚
â”‚ â”œâ”€â”€ LOC: 145,230                                             â”‚
â”‚ â”œâ”€â”€ Scan Time: 30-90 seconds                                 â”‚
â”‚ â”œâ”€â”€ Memory: ~300 MB                                          â”‚
â”‚ â””â”€â”€ Findings: 10-50                                          â”‚
â”‚                                                              â”‚
â”‚ Large Monorepo (10k-50k files)                               â”‚
â”‚ â”œâ”€â”€ Files: 18,450                                            â”‚
â”‚ â”œâ”€â”€ LOC: 1,234,567                                           â”‚
â”‚ â”œâ”€â”€ Scan Time: 2-5 minutes                                   â”‚
â”‚ â”œâ”€â”€ Memory: ~800 MB                                          â”‚
â”‚ â””â”€â”€ Findings: 50-200                                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Optimization Strategies                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ 1. Parallel Execution                                        â”‚
â”‚    - Run adapters concurrently (3-4 tools in parallel)       â”‚
â”‚    - Impact: 3x faster than sequential                       â”‚
â”‚                                                              â”‚
â”‚ 2. Smart Exclusions                                          â”‚
â”‚    - Skip node_modules, .git, dist, build                    â”‚
â”‚    - Impact: 10x faster (2 min â†’ 12 sec)                     â”‚
â”‚                                                              â”‚
â”‚ 3. Incremental Scanning                                      â”‚
â”‚    - Git diff to find changed files                          â”‚
â”‚    - Impact: 20x faster for PRs                              â”‚
â”‚                                                              â”‚
â”‚ 4. Result Caching                                            â”‚
â”‚    - Cache file hashes and previous results                  â”‚
â”‚    - Impact: 5x faster on repeated scans                     â”‚
â”‚                                                              â”‚
â”‚ 5. Binary Detection                                          â”‚
â”‚    - Skip binary files (images, PDFs, executables)           â”‚
â”‚    - Impact: 2x faster                                       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security Considerations

### Sensitive Data Handling

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ How the scanner handles discovered secrets                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Secret Discovery
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TruffleHog finds API key:       â”‚
â”‚ "sk-proj-abc123def456..."       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redaction (Optional)            â”‚
â”‚ Before: "sk-proj-abc123def..."  â”‚
â”‚ After:  "sk-proj-abc***"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Storage                         â”‚
â”‚ â”œâ”€â”€ Memory only (not persisted) â”‚
â”‚ â”œâ”€â”€ Reports: Redacted           â”‚
â”‚ â””â”€â”€ Logs: Never logged          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Output                          â”‚
â”‚ â”œâ”€â”€ Terminal: Show location    â”‚
â”‚ â”œâ”€â”€ SARIF: Redacted snippet     â”‚
â”‚ â””â”€â”€ JSON: Redacted value        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Security Best Practices:
1. Never log full secrets
2. Redact in all output formats
3. Clear memory after scan
4. Encrypt reports if persisted
5. Use secure temp directories
```

---

## Extensibility Points

### Adding New Tool Adapters

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Custom Adapter: Example - Bandit (Python SAST)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Create adapter file
   packages/adapters/src/bandit/adapter.ts

2. Implement interface
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ export class BanditAdapter extends      â”‚
   â”‚   BaseSecurityToolAdapter {             â”‚
   â”‚                                         â”‚
   â”‚   name = 'bandit';                      â”‚
   â”‚   version = '1.0.0';                    â”‚
   â”‚                                         â”‚
   â”‚   async scan(target: ScanTarget) {      â”‚
   â”‚     // Execute bandit command           â”‚
   â”‚     const result = await exec(          â”‚
   â”‚       `bandit -r ${target.path} -f json`â”‚
   â”‚     );                                  â”‚
   â”‚     return result.stdout;               â”‚
   â”‚   }                                     â”‚
   â”‚                                         â”‚
   â”‚   async parse(output: string) {         â”‚
   â”‚     // Parse bandit JSON                â”‚
   â”‚     const data = JSON.parse(output);    â”‚
   â”‚     return data.results.map(r => ({     â”‚
   â”‚       severity: mapSeverity(r.issue_    â”‚
   â”‚         severity),                      â”‚
   â”‚       file: r.filename,                 â”‚
   â”‚       line: r.line_number,              â”‚
   â”‚       ...                               â”‚
   â”‚     }));                                â”‚
   â”‚   }                                     â”‚
   â”‚ }                                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Register adapter
   packages/core/src/scanner/orchestrator.ts
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ import { BanditAdapter } from           â”‚
   â”‚   '@adapters/bandit';                   â”‚
   â”‚                                         â”‚
   â”‚ this.adapters.set('bandit',             â”‚
   â”‚   new BanditAdapter());                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. Add configuration
   .securityrc.json
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ {                                       â”‚
   â”‚   "tools": {                            â”‚
   â”‚     "bandit": {                         â”‚
   â”‚       "enabled": true,                  â”‚
   â”‚       "severity": ["HIGH", "MEDIUM"]    â”‚
   â”‚     }                                   â”‚
   â”‚   }                                     â”‚
   â”‚ }                                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. Done! New tool integrated
```

---

## Glossary

| Term | Definition |
|------|------------|
| **Adapter** | Interface layer between scanner core and external security tools |
| **Deduplication** | Process of removing duplicate findings from multiple tools |
| **False Positive** | Finding that is flagged as an issue but is actually safe |
| **Finding** | Security issue, vulnerability, or code quality problem detected |
| **Orchestrator** | Core component that coordinates scan execution |
| **SARIF** | Static Analysis Results Interchange Format (JSON-based) |
| **Severity** | Risk level of a finding (CRITICAL, HIGH, MEDIUM, LOW) |
| **Snippet** | Code excerpt showing the vulnerable code |
| **Tool** | External security scanner (TruffleHog, Semgrep, etc.) |

---

## Related Documentation

- [Quick Start Guide](../QUICK_START.md) - Get started in 5-10 minutes
- [Configuration Reference](CONFIGURATION.md) - All configuration options
- [Custom Rules Guide](CUSTOM_RULES.md) - Write your own security rules
- [API Documentation](API.md) - Programmatic usage
- [Contributing Guide](../CONTRIBUTING.md) - How to contribute

---

**Document Status:** âœ… Complete
**Maintained by:** Security Scanner Team
**Last Review:** November 11, 2025
**Next Review:** February 2026
